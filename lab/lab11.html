<h2>The wrong way and the right way to do cross-validation</h2>
<br>
<br>

<p>In this lab, we simulate the wrong way and the right way to perform cross validation, as explained in Lecture 11 and in Section 7.10 of the Elements of Statistical Learning.</p>

<p>We will work under the null hypothesis that there are 1000 standard normal predictors, which are uncorrelated from the response, which is uniform in {0,1}.</p>

<pre><code class="r">n = 200
p = 1000
X = as.data.frame(matrix(rnorm(n*p),n))
Y = runif(200)&lt;0.5
X$Y = Y
</code></pre>

<p>Here we define a function to perform variable selection. It selects the 20 variables with the highest correlation with the response.</p>

<pre><code class="r">PickBest &lt;- function(X,p) {
  # Pick 20 variables with highest correlation to response
  correlations = c()
  for (i in 1:p) {
    correlations = c(correlations,cor(X[,i],X$Y))
  }
  sorted = sort(correlations,index.return=T,decreasing=T)
  sorted$ix[1:20]
}
</code></pre>

<p>Now, we are ready to define functions to perform cross-validation the wrong way and the right way. The only difference is that in the former, we perform the variable selection before cross validation using all the samples. In the latter, we perform the variable selection within a 10-fold cross validation loop.</p>

<pre><code class="r">WrongCV &lt;- function(X,n,p) {
  best20 = PickBest(X,p)
  order = sample(1:n)
  errors = c()
  for (i in 1:10) {
    test = ((1:n)&lt;=i*n/10) &amp; ((1:n)&gt;(i-1)*n/10)
    train = !test
    glm.fit = glm(Y~.,data=X[order[train],c(best20,p+1)],family=binomial)
    glm.pred = predict(glm.fit,newdata=X[order[test],c(best20,p+1)],type=&quot;response&quot;)
    glm.pred = glm.pred&gt;0.5
    errors = c(errors,mean(glm.pred!=X[order[test],&#39;Y&#39;]))
  }
  mean(errors)
}

RightCV &lt;- function(X,n,p) {
  order = sample(1:n)
  errors = c()
  for (i in 1:10) {
    test = ((1:n)&lt;=i*n/10) &amp; ((1:n)&gt;(i-1)*n/10)
    train = !test
    # Pick best 20
    best20 = PickBest(X[order[train],],p)
    # Fit model to best predictors
    glm.fit = glm(Y~.,data=X[order[train],c(best20,p+1)],family=binomial)
    glm.pred = predict(glm.fit,newdata=X[order[test],c(best20,p+1)],type=&quot;response&quot;)
    glm.pred = glm.pred&gt;0.5
    errors = c(errors,mean(glm.pred!=X[order[test],&#39;Y&#39;]))
  }
  mean(errors)
}
</code></pre>

<p>Now, we are ready to evaluate each method. We will estimate the error 100 times the wrong way and 100 times the right way.</p>

<pre><code class="r">n = 200
p = 1000
wErrors = c()
rErrors = c()
for (i in 1:100) {
  X = as.data.frame(matrix(rnorm(n*p),n))
  Y = runif(200)&lt;0.5
  X$Y = Y
  wErrors = c(wErrors,WrongCV(X,n,p))
  rErrors = c(rErrors,RightCV(X,n,p))
}
errors = data.frame(&#39;Error&#39;=c(wErrors,rErrors),
                    &#39;Method&#39;=c(rep(&#39;Wrong way&#39;,100),rep(&#39;Right way&#39;,100)))
</code></pre>

<p>Now, we can visualize the errors in a box plot.</p>

<pre><code class="r">library(ggplot2)
</code></pre>


<pre><code class="r">ggplot(errors,aes(y=Error,x=Method)) + geom_boxplot()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-5"/> </p>

<p>As expected, the right method estimates an error of 50% on average, whereas the wrong method significantly underestimates the error.</p>

<p>As an exercise, you can modify this code to study the effect of changing the size of the folds in cross validation.</p>


    <script type="text/javascript"
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
